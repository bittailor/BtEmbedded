//*************************************************************************************************
//
//  BITTAILOR.CH - BtCore
//
//-------------------------------------------------------------------------------------------------
//
//  Bt::Mcu::SpiPlatform
//  
//*************************************************************************************************

#include "Bt/Mcu/SpiPlatform.hpp"

#include <bcm2835.h>

#include "Bt/Mcu/GpioLibrary.hpp"


namespace Bt {
namespace Mcu {


//-------------------------------------------------------------------------------------------------

SpiPlatform::SpiPlatform() {
   GpioLibrary::ensureIsInitialized();
   bcm2835_spi_begin();
   bcm2835_spi_chipSelect(BCM2835_SPI_CS_NONE);
}

//-------------------------------------------------------------------------------------------------

SpiPlatform::~SpiPlatform() {
   bcm2835_spi_end();
}

//-------------------------------------------------------------------------------------------------

uint8_t SpiPlatform::transfer(uint8_t pData)
{
   return bcm2835_spi_transfer(pData);
}

//-------------------------------------------------------------------------------------------------

} // namespace Mcu
} // namespace Bt
